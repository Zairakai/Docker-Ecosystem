# Architecture Comparison: 3 Testing Modes

<!-- CI/CD & Quality -->
[![License][license-badge]][license]
[![Pipeline][pipeline-badge]][pipeline]

[ğŸ  Home][home] > [ğŸ“š Documentation][docs] > Architecture Comparison

This document compares the three distinct architectural modes supported by the Zairakai Docker Ecosystem.

## Table of Contents

- [Architecture Comparison: 3 Testing Modes](#architecture-comparison-3-testing-modes)
  - [Table of Contents](#table-of-contents)
  - [Quick Reference Table](#quick-reference-table)
  - [Mode 1: Blade-only (Pure SSR)](#mode-1-blade-only-pure-ssr)
    - [Architecture Diagram](#architecture-diagram)
    - [Key Characteristics](#key-characteristics)
    - [Directory Structure](#directory-structure)
    - [Example Blade Template](#example-blade-template)
    - [Testing](#testing)
    - [Gherkin Test Example](#gherkin-test-example)
  - [Mode 2: SPA-only (Decoupled Architecture)](#mode-2-spa-only-decoupled-architecture)
    - [Architecture Diagram](#architecture-diagram-1)
    - [Key Characteristics](#key-characteristics-1)
    - [Directory Structure](#directory-structure-1)
    - [Vue.js App Structure](#vuejs-app-structure)
    - [Laravel API Routes](#laravel-api-routes)
    - [Build \& Testing Workflow](#build--testing-workflow)
    - [Nginx Configuration](#nginx-configuration)
    - [Gherkin Test Example](#gherkin-test-example-1)
  - [Mode 3: Hybrid (Laravel + Vite Standard)](#mode-3-hybrid-laravel--vite-standard)
    - [Architecture Diagram](#architecture-diagram-2)
    - [Key Characteristics](#key-characteristics-2)
    - [Directory Structure](#directory-structure-2)
    - [Blade Template with Vue.js](#blade-template-with-vuejs)
    - [Vue.js Component](#vuejs-component)
    - [Build \& Testing Workflow](#build--testing-workflow-1)
    - [Gherkin Test Example](#gherkin-test-example-2)
  - [Choosing the Right Mode](#choosing-the-right-mode)
    - [Use Blade-only when](#use-blade-only-when)
    - [Use SPA-only when](#use-spa-only-when)
    - [Use Hybrid when](#use-hybrid-when)
  - [Testing Strategy per Mode](#testing-strategy-per-mode)
  - [Performance Comparison](#performance-comparison)
  - [Conclusion](#conclusion)
  - [Navigation](#navigation)
  - [Support](#support)

## Quick Reference Table

| Feature | Blade-only | SPA-only | Hybrid (Laravel + Vite) |
| ------- | ---------- | -------- | ----------------------- |
| **Frontend Framework** | None | Vue.js standalone | Vue.js in Laravel |
| **Rendering** | Server-side (PHP) | Client-side (JS) | Both |
| **Node.js Build** | Not needed | Required | Required |
| **Asset Location** | public/css, public/js | dist/ (separate) | public/build/ (Laravel) |
| **Backend** | Laravel (Blade views) | Laravel API only | Laravel (Blade + API) |
| **CORS** | Not needed | Required | Not needed |
| **Complexity** | Low | Medium | Medium |
| **Use Case** | Traditional web app | Modern SPA | Progressive enhancement |

## Mode 1: Blade-only (Pure SSR)

### Architecture Diagram

```txt
Browser
   â†“ HTTP Request
Nginx (port 80)
   â†“ Forward to PHP-FPM
PHP (Laravel)
   â†“ Render Blade template
HTML Response (complete page)
   â†“
Browser displays content
```

### Key Characteristics

- **No JavaScript framework**: Pure HTML generated by PHP
- **No build step**: CSS/JS (if any) served directly from public/
- **No Node.js container**: PHP only
- **Simple deployment**: Just PHP + Database

### Directory Structure

```bash
laravel/
â”œâ”€â”€ resources/
â”‚   â””â”€â”€ views/              # Blade templates
â”‚       â”œâ”€â”€ home.blade.php
â”‚       â””â”€â”€ about.blade.php
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ css/                # Plain CSS (no compilation)
â”‚   â”‚   â””â”€â”€ app.css
â”‚   â”œâ”€â”€ js/                 # Vanilla JS (no framework)
â”‚   â”‚   â””â”€â”€ app.js
â”‚   â””â”€â”€ index.php
â””â”€â”€ routes/
    â””â”€â”€ web.php             # Web routes only
```

### Example Blade Template

```html
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="/css/app.css">
</head>
<body>
    <h1>Welcome, {{ $user->name }}</h1>

    <ul>
        @foreach($posts as $post)
            <li>{{ $post->title }}</li>
        @endforeach
    </ul>

    <script src="/js/app.js"></script>
</body>
</html>
```

### Testing

```bash
# No build step required
docker-compose -f examples/docker-compose-mode-blade.yml up

# Tests verify server-rendered HTML
# No JavaScript execution needed
```

### Gherkin Test Example

```gherkin
Scenario: Homepage displays user data
  Given I navigate to "http://nginx/"
  Then the HTML should contain "Welcome, John Doe"
  And the page should have a list with 5 posts
  # All content in HTML immediately, no JS needed
```

## Mode 2: SPA-only (Decoupled Architecture)

### Architecture Diagram

```txt
Browser
   â†“ HTTP Request "/"
Nginx (port 80)
   â†“ Serve static file
dist/index.html
   â†“ Browser loads Vue.js
Vue.js App starts
   â†“ API call "/api/users"
Nginx
   â†“ Proxy to PHP-FPM
PHP (Laravel API)
   â†“ JSON Response
Vue.js renders UI
```

### Key Characteristics

- **Completely decoupled**: Frontend and backend are separate projects
- **Vue.js standalone**: SPA built with Vite, served as static files
- **Laravel API only**: No Blade views, routes/api.php only
- **CORS required**: Cross-origin requests from SPA to API
- **Two separate codebases**: Vue.js app + Laravel API

### Directory Structure

```bash
# Separate projects
vuejs-app/                  # Vue.js SPA project
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.js
â”‚   â”œâ”€â”€ App.vue
â”‚   â”œâ”€â”€ components/
â”‚   â””â”€â”€ views/
â”œâ”€â”€ public/
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ dist/                   # Build output (served by Nginx)
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ assets/
â”‚       â”œâ”€â”€ index-abc123.js
â”‚       â””â”€â”€ index-abc123.css
â”œâ”€â”€ package.json
â””â”€â”€ vite.config.js

laravel-api/                # Laravel API project
â”œâ”€â”€ app/
â”‚   â””â”€â”€ Http/
â”‚       â””â”€â”€ Controllers/
â”‚           â””â”€â”€ Api/        # API controllers only
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ api.php            # API routes only (no web.php)
â””â”€â”€ config/
    â””â”€â”€ cors.php           # CORS configuration
```

### Vue.js App Structure

```javascript
// src/main.js
import { createApp } from 'vue'
import { createRouter } from 'vue-router'
import App from './App.vue'

const router = createRouter({
  routes: [
    { path: '/', component: Home },
    { path: '/users', component: Users }
  ]
})

const app = createApp(App)
app.use(router)
app.mount('#app')
```

### Laravel API Routes

```php
// routes/api.php
Route::middleware('api')
  ->controller(UserController::class)
  ->group(function () {
    Route::get('/users', 'index');
    Route::get('/users/{id}', 'show');
    Route::post('/users', 'store');
  });

// No web.php routes, API only
```

### Build & Testing Workflow

```bash
# Step 1: Build Vue.js SPA
docker-compose up node-build
# â†’ npm run build
# â†’ Output: vuejs-app/dist/index.html + assets

# Step 2: Test
docker-compose up nginx php-api e2e-testing
# Nginx serves dist/index.html
# Vue.js calls /api/* â†’ PHP-FPM â†’ Laravel API
```

### Nginx Configuration

```nginx
# Serve Vue.js static files
root /var/www/html/dist;

location / {
    try_files $uri /index.html;  # SPA client-side routing
}

# Proxy API calls to Laravel
location /api {
    fastcgi_pass php-api:9000;
    # CORS headers
    add_header 'Access-Control-Allow-Origin' '*';
}
```

### Gherkin Test Example

```gherkin
Scenario: SPA loads user list from API
  Given I navigate to "http://nginx/"
  When I wait for Vue.js to mount
  And I click on "Users" link
  Then the URL should be "http://nginx/users"
  And I should see a loading spinner
  When the API call to "/api/users" completes
  Then I should see 10 user cards
  # All content loaded via JavaScript + API
```

## Mode 3: Hybrid (Laravel + Vite Standard)

### Architecture Diagram

```txt
Browser
   â†“ HTTP Request "/"
Nginx (port 80)
   â†“ Forward to PHP-FPM
PHP (Laravel)
   â†“ Render Blade template
   â†“ @vite directive reads manifest.json
Blade HTML with <script src="/build/assets/app-abc123.js">
   â†“
Browser loads HTML (SSR content visible)
   â†“
Browser loads /build/assets/app-abc123.js
   â†“ PHP serves from public/build/
Vue.js mounts and hydrates components
```

### Key Characteristics

- **Best of both worlds**: Blade SSR + Vue.js components
- **Single codebase**: Laravel project with Vue.js inside
- **Vite integration**: Laravel official asset bundler
- **Progressive enhancement**: Start with Blade, add Vue.js where needed
- **Assets in Laravel**: Vue.js compiled to public/build/

### Directory Structure

```bash
laravel/
â”œâ”€â”€ resources/
â”‚   â”œâ”€â”€ views/              # Blade templates
â”‚   â”‚   â””â”€â”€ dashboard.blade.php
â”‚   â”œâ”€â”€ js/                 # Vue.js components
â”‚   â”‚   â”œâ”€â”€ app.js          # Entry point
â”‚   â”‚   â””â”€â”€ Components/
â”‚   â”‚       â””â”€â”€ Dashboard.vue
â”‚   â””â”€â”€ css/
â”‚       â””â”€â”€ app.css
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ build/              # Generated by Vite
â”‚   â”‚   â”œâ”€â”€ manifest.json
â”‚   â”‚   â””â”€â”€ assets/
â”‚   â”‚       â”œâ”€â”€ app-abc123.js
â”‚   â”‚       â””â”€â”€ app-abc123.css
â”‚   â””â”€â”€ index.php
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ web.php             # Blade routes
â”‚   â””â”€â”€ api.php             # API routes for Vue.js
â”œâ”€â”€ package.json            # Node.js dependencies
â””â”€â”€ vite.config.js          # Vite configuration
```

### Blade Template with Vue.js

```html
<!DOCTYPE html>
<html>
<head>
    {{-- Vite directive automatically includes compiled assets --}}
    @vite(['resources/css/app.css', 'resources/js/app.js'])
</head>
<body>
    {{-- Server-rendered Blade content --}}
    <header>
        <h1>Welcome, {{ $user->name }}</h1>
    </header>

    {{-- Vue.js component mount point --}}
    <div id="app">
        <dashboard-component :user="{{ $user }}"></dashboard-component>
    </div>

    {{-- More Blade SSR content --}}
    <footer>
        <p>&copy; 2025</p>
    </footer>
</body>
</html>
```

Generated HTML:

```html
<head>
    <link rel="stylesheet" href="/build/assets/app-abc123.css">
    <script type="module" src="/build/assets/app-abc123.js"></script>
</head>
<body>
    <header>
        <h1>Welcome, John Doe</h1>  <!-- Immediate SSR content -->
    </header>
    <div id="app">
        <!-- Vue.js will mount here -->
    </div>
</body>
```

### Vue.js Component

```javascript
<!-- resources/js/Components/Dashboard.vue -->
<template>
  <div class="dashboard">
    <h2>Dashboard for {{ user.name }}</h2>
    <chart :data="chartData"></chart>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'

const props = defineProps(['user'])
const chartData = ref([])

onMounted(async () => {
  // Fetch dynamic data from Laravel API
  const res = await fetch('/api/dashboard/data')
  chartData.value = await res.json()
})
</script>
```

### Build & Testing Workflow

```bash
# Step 1: Build Vue.js assets into Laravel public/build/
docker-compose up node-build
# â†’ npm install
# â†’ npm run build
# â†’ Output: public/build/manifest.json + assets/

# Step 2: Test
docker-compose up nginx php e2e-testing
# PHP serves everything from public/ including public/build/
```

### Gherkin Test Example

```gherkin
Scenario: Hybrid page with SSR and Vue.js
  Given I navigate to "http://nginx/dashboard"

  # Server-rendered content is immediate
  Then I should see "Welcome, John Doe" immediately
  And the header should be visible without JavaScript

  # Vue.js component loads after
  When I wait for Vue.js component "dashboard-component" to mount
  Then the dashboard chart should be visible
  And the chart should fetch data from "/api/dashboard/data"
  And the chart should be interactive
```

## Choosing the Right Mode

### Use Blade-only when

- Building traditional server-rendered applications
- No need for complex JavaScript interactions
- Simplicity is priority
- SEO is critical and JS is not needed

### Use SPA-only when

- Building modern app-like experiences
- Frontend team separate from backend team
- Need for offline capabilities (PWA)
- Complex client-side state management

### Use Hybrid when

- Starting with Laravel, adding Vue.js progressively
- Need both SSR (SEO, initial load) and SPA (interactivity)
- Single team managing both frontend and backend
- Most common real-world Laravel + Vue.js setup

## Testing Strategy per Mode

| Aspect | Blade-only | SPA-only | Hybrid |
| ------ | ---------- | -------- | ------ |
| **HTML Structure** | Test immediately | Wait for Vue.js render | Test both SSR and Vue.js |
| **JavaScript** | Minimal or none | Essential | Progressive |
| **Wait Times** | Low | High (API + render) | Medium |
| **SEO Testing** | Direct HTML | Not applicable | SSR content only |
| **API Testing** | Not applicable | Via browser | Via browser |

## Performance Comparison

| Metric | Blade-only | SPA-only | Hybrid |
| ------ | ---------- | -------- | ------ |
| **Time to First Byte** | Fast | Fast (static) | Fast |
| **First Contentful Paint** | Fast | Slow | Fast (SSR) |
| **Time to Interactive** | Immediate | Slow | Medium |
| **Bundle Size** | Small | Large | Medium |
| **Server Load** | High | Low | Medium |

## Conclusion

All three modes are valid depending on your use case. The Docker ecosystem supports all three seamlessly
with minimal configuration changes.

## Navigation

- [â† Docker Swarm Deployment][swarm]
- [ğŸ“š Documentation Index][docs]
- [Reference Guide â†’][reference]

**Learn More:**

- **[Testing Modes][testing-modes]** - Detailed testing strategies
- **[Architecture Guide][architecture]** - System design patterns
- **[Reference Guide][reference]** - Complete configuration reference

## Support

[![Issues][issues-badge]][issues]
[![Discord][discord-badge]][discord]

<!-- Badge References -->
[pipeline-badge]: https://gitlab.com/zairakai/docker-ecosystem/badges/main/pipeline.svg
[pipeline]: https://gitlab.com/zairakai/docker-ecosystem/-/pipelines
[license-badge]: https://img.shields.io/badge/license-MIT-blue.svg
[license]: ../LICENSE
[discord-badge]: https://img.shields.io/discord/1260000352699289621?logo=discord&label=Discord&color=5865F2
[discord]: https://discord.gg/MAmD5SG8Zu
[issues-badge]: https://img.shields.io/gitlab/issues/open-raw/zairakai%2Fdocker-ecosystem?logo=gitlab&label=Issues
[issues]: https://gitlab.com/zairakai/docker-ecosystem/-/issues

<!-- Reference Links -->

[home]: ../README.md
[docs]: INDEX.md
[swarm]: SWARM.md
[reference]: REFERENCE.md
[testing-modes]: TESTING_MODES.md
[architecture]: ARCHITECTURE.md
